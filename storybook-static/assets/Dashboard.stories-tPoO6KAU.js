var Re=e=>{throw TypeError(e)};var le=(e,t,s)=>t.has(e)||Re("Cannot "+s);var n=(e,t,s)=>(le(e,t,"read from private field"),s?s.call(e):t.get(e)),p=(e,t,s)=>t.has(e)?Re("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,s),f=(e,t,s,r)=>(le(e,t,"write to private field"),r?r.call(e,s):t.set(e,s),s),v=(e,t,s)=>(le(e,t,"access private method"),s);import{j as i}from"./jsx-runtime-COnr8Gy3.js";import{r as L}from"./index-CoXXcpNP.js";import{c as Je,T as ht,a as ft,b as Me,d as ue,e as mt,f as de,B as gt,g as pt,u as Ke,h as yt,C as T,i as I,j as Q,k as U,F as Ge,l as xt,m as we,D as vt,s as Xe,M as bt,n as Ze,o as b,J as y,v as Y,p as wt}from"./vi.ClIskdbk-DCcnHgWe.js";import"./index-D0xE3iFU.js";import"./iframe-DamR9qN4.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jt=Je("ExternalLink",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ct=Je("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);var je=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(e){return this.listeners.add(e),this.onSubscribe(),()=>{this.listeners.delete(e),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},re=typeof window>"u"||"Deno"in globalThis;function St(){}function _e(e){return typeof e=="number"&&e>=0&&e!==1/0}function Lt(e,t){return Math.max(e+(t||0)-Date.now(),0)}function se(e,t){return typeof e=="function"?e(t):e}function N(e,t){return typeof e=="function"?e(t):e}function et(e,t){if(e===t)return e;const s=De(e)&&De(t);if(s||Oe(e)&&Oe(t)){const r=s?e:Object.keys(e),a=r.length,c=s?t:Object.keys(t),l=c.length,o=s?[]:{};let h=0;for(let x=0;x<l;x++){const u=s?x:c[x];(!s&&r.includes(u)||s)&&e[u]===void 0&&t[u]===void 0?(o[u]=void 0,h++):(o[u]=et(e[u],t[u]),o[u]===e[u]&&e[u]!==void 0&&h++)}return a===l&&h===a?e:o}return t}function he(e,t){if(!t||Object.keys(e).length!==Object.keys(t).length)return!1;for(const s in e)if(e[s]!==t[s])return!1;return!0}function De(e){return Array.isArray(e)&&e.length===Object.keys(e).length}function Oe(e){if(!ke(e))return!1;const t=e.constructor;if(t===void 0)return!0;const s=t.prototype;return!(!ke(s)||!s.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(e)!==Object.prototype)}function ke(e){return Object.prototype.toString.call(e)==="[object Object]"}function Fe(e,t,s){return typeof s.structuralSharing=="function"?s.structuralSharing(e,t):s.structuralSharing!==!1?et(e,t):t}var k,R,q,Te,Et=(Te=class extends je{constructor(){super();p(this,k);p(this,R);p(this,q);f(this,q,t=>{if(!re&&window.addEventListener){const s=()=>t();return window.addEventListener("visibilitychange",s,!1),()=>{window.removeEventListener("visibilitychange",s)}}})}onSubscribe(){n(this,R)||this.setEventListener(n(this,q))}onUnsubscribe(){var t;this.hasListeners()||((t=n(this,R))==null||t.call(this),f(this,R,void 0))}setEventListener(t){var s;f(this,q,t),(s=n(this,R))==null||s.call(this),f(this,R,t(r=>{typeof r=="boolean"?this.setFocused(r):this.onFocus()}))}setFocused(t){n(this,k)!==t&&(f(this,k,t),this.onFocus())}onFocus(){const t=this.isFocused();this.listeners.forEach(s=>{s(t)})}isFocused(){var t;return typeof n(this,k)=="boolean"?n(this,k):((t=globalThis.document)==null?void 0:t.visibilityState)!=="hidden"}},k=new WeakMap,R=new WeakMap,q=new WeakMap,Te),Nt=new Et,$,M,B,Ie,Rt=(Ie=class extends je{constructor(){super();p(this,$,!0);p(this,M);p(this,B);f(this,B,t=>{if(!re&&window.addEventListener){const s=()=>t(!0),r=()=>t(!1);return window.addEventListener("online",s,!1),window.addEventListener("offline",r,!1),()=>{window.removeEventListener("online",s),window.removeEventListener("offline",r)}}})}onSubscribe(){n(this,M)||this.setEventListener(n(this,B))}onUnsubscribe(){var t;this.hasListeners()||((t=n(this,M))==null||t.call(this),f(this,M,void 0))}setEventListener(t){var s;f(this,B,t),(s=n(this,M))==null||s.call(this),f(this,M,t(this.setOnline.bind(this)))}setOnline(t){n(this,$)!==t&&(f(this,$,t),this.listeners.forEach(r=>{r(t)}))}isOnline(){return n(this,$)}},$=new WeakMap,M=new WeakMap,B=new WeakMap,Ie),Mt=new Rt;function _t(e){return(e??"online")==="online"?Mt.isOnline():!0}function Dt(){let e=[],t=0,s=o=>{o()},r=o=>{o()},a=o=>setTimeout(o,0);const c=o=>{t?e.push(o):a(()=>{s(o)})},l=()=>{const o=e;e=[],o.length&&a(()=>{r(()=>{o.forEach(h=>{s(h)})})})};return{batch:o=>{let h;t++;try{h=o()}finally{t--,t||l()}return h},batchCalls:o=>(...h)=>{c(()=>{o(...h)})},schedule:c,setNotifyFunction:o=>{s=o},setBatchNotifyFunction:o=>{r=o},setScheduler:o=>{a=o}}}var tt=Dt();function Ot(e,t){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:_t(t.networkMode)?"fetching":"paused",...e===void 0&&{error:null,status:"pending"}}}var j,d,K,w,F,H,E,G,V,z,P,A,_,W,m,J,fe,me,ge,pe,ye,xe,ve,st,Qe,kt=(Qe=class extends je{constructor(t,s){super();p(this,m);p(this,j);p(this,d);p(this,K);p(this,w);p(this,F);p(this,H);p(this,E);p(this,G);p(this,V);p(this,z);p(this,P);p(this,A);p(this,_);p(this,W,new Set);this.options=s,f(this,j,t),f(this,E,null),this.bindMethods(),this.setOptions(s)}bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(n(this,d).addObserver(this),Pe(n(this,d),this.options)?v(this,m,J).call(this):this.updateResult(),v(this,m,pe).call(this))}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return be(n(this,d),this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return be(n(this,d),this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,v(this,m,ye).call(this),v(this,m,xe).call(this),n(this,d).removeObserver(this)}setOptions(t,s){const r=this.options,a=n(this,d);if(this.options=n(this,j).defaultQueryOptions(t),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof N(this.options.enabled,n(this,d))!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");v(this,m,ve).call(this),n(this,d).setOptions(this.options),r._defaulted&&!he(this.options,r)&&n(this,j).getQueryCache().notify({type:"observerOptionsUpdated",query:n(this,d),observer:this});const c=this.hasListeners();c&&Ae(n(this,d),a,this.options,r)&&v(this,m,J).call(this),this.updateResult(s),c&&(n(this,d)!==a||N(this.options.enabled,n(this,d))!==N(r.enabled,n(this,d))||se(this.options.staleTime,n(this,d))!==se(r.staleTime,n(this,d)))&&v(this,m,fe).call(this);const l=v(this,m,me).call(this);c&&(n(this,d)!==a||N(this.options.enabled,n(this,d))!==N(r.enabled,n(this,d))||l!==n(this,_))&&v(this,m,ge).call(this,l)}getOptimisticResult(t){const s=n(this,j).getQueryCache().build(n(this,j),t),r=this.createResult(s,t);return Pt(this,r)&&(f(this,w,r),f(this,H,this.options),f(this,F,n(this,d).state)),r}getCurrentResult(){return n(this,w)}trackResult(t,s){const r={};return Object.keys(t).forEach(a=>{Object.defineProperty(r,a,{configurable:!1,enumerable:!0,get:()=>(this.trackProp(a),s==null||s(a),t[a])})}),r}trackProp(t){n(this,W).add(t)}getCurrentQuery(){return n(this,d)}refetch({...t}={}){return this.fetch({...t})}fetchOptimistic(t){const s=n(this,j).defaultQueryOptions(t),r=n(this,j).getQueryCache().build(n(this,j),s);return r.isFetchingOptimistic=!0,r.fetch().then(()=>this.createResult(r,s))}fetch(t){return v(this,m,J).call(this,{...t,cancelRefetch:t.cancelRefetch??!0}).then(()=>(this.updateResult(),n(this,w)))}createResult(t,s){var Ne;const r=n(this,d),a=this.options,c=n(this,w),l=n(this,F),o=n(this,H),x=t!==r?t.state:n(this,K),{state:u}=t;let g={...u},D=!1,C;if(s._optimisticResults){const S=this.hasListeners(),ce=!S&&Pe(t,s),dt=S&&Ae(t,r,s,a);(ce||dt)&&(g={...g,...Ot(u.data,t.options)}),s._optimisticResults==="isRestoring"&&(g.fetchStatus="idle")}let{error:X,errorUpdatedAt:Se,status:O}=g;if(s.select&&g.data!==void 0)if(c&&g.data===(l==null?void 0:l.data)&&s.select===n(this,G))C=n(this,V);else try{f(this,G,s.select),C=s.select(g.data),C=Fe(c==null?void 0:c.data,C,s),f(this,V,C),f(this,E,null)}catch(S){f(this,E,S)}else C=g.data;if(s.placeholderData!==void 0&&C===void 0&&O==="pending"){let S;if(c!=null&&c.isPlaceholderData&&s.placeholderData===(o==null?void 0:o.placeholderData))S=c.data;else if(S=typeof s.placeholderData=="function"?s.placeholderData((Ne=n(this,z))==null?void 0:Ne.state.data,n(this,z)):s.placeholderData,s.select&&S!==void 0)try{S=s.select(S),f(this,E,null)}catch(ce){f(this,E,ce)}S!==void 0&&(O="success",C=Fe(c==null?void 0:c.data,S,s),D=!0)}n(this,E)&&(X=n(this,E),C=n(this,V),Se=Date.now(),O="error");const ne=g.fetchStatus==="fetching",ae=O==="pending",oe=O==="error",Le=ae&&ne,Ee=C!==void 0;return{status:O,fetchStatus:g.fetchStatus,isPending:ae,isSuccess:O==="success",isError:oe,isInitialLoading:Le,isLoading:Le,data:C,dataUpdatedAt:g.dataUpdatedAt,error:X,errorUpdatedAt:Se,failureCount:g.fetchFailureCount,failureReason:g.fetchFailureReason,errorUpdateCount:g.errorUpdateCount,isFetched:g.dataUpdateCount>0||g.errorUpdateCount>0,isFetchedAfterMount:g.dataUpdateCount>x.dataUpdateCount||g.errorUpdateCount>x.errorUpdateCount,isFetching:ne,isRefetching:ne&&!ae,isLoadingError:oe&&!Ee,isPaused:g.fetchStatus==="paused",isPlaceholderData:D,isRefetchError:oe&&Ee,isStale:Ce(t,s),refetch:this.refetch}}updateResult(t){const s=n(this,w),r=this.createResult(n(this,d),this.options);if(f(this,F,n(this,d).state),f(this,H,this.options),n(this,F).data!==void 0&&f(this,z,n(this,d)),he(r,s))return;f(this,w,r);const a={},c=()=>{if(!s)return!0;const{notifyOnChangeProps:l}=this.options,o=typeof l=="function"?l():l;if(o==="all"||!o&&!n(this,W).size)return!0;const h=new Set(o??n(this,W));return this.options.throwOnError&&h.add("error"),Object.keys(n(this,w)).some(x=>{const u=x;return n(this,w)[u]!==s[u]&&h.has(u)})};(t==null?void 0:t.listeners)!==!1&&c()&&(a.listeners=!0),v(this,m,st).call(this,{...a,...t})}onQueryUpdate(){this.updateResult(),this.hasListeners()&&v(this,m,pe).call(this)}},j=new WeakMap,d=new WeakMap,K=new WeakMap,w=new WeakMap,F=new WeakMap,H=new WeakMap,E=new WeakMap,G=new WeakMap,V=new WeakMap,z=new WeakMap,P=new WeakMap,A=new WeakMap,_=new WeakMap,W=new WeakMap,m=new WeakSet,J=function(t){v(this,m,ve).call(this);let s=n(this,d).fetch(this.options,t);return t!=null&&t.throwOnError||(s=s.catch(St)),s},fe=function(){v(this,m,ye).call(this);const t=se(this.options.staleTime,n(this,d));if(re||n(this,w).isStale||!_e(t))return;const r=Lt(n(this,w).dataUpdatedAt,t)+1;f(this,P,setTimeout(()=>{n(this,w).isStale||this.updateResult()},r))},me=function(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(n(this,d)):this.options.refetchInterval)??!1},ge=function(t){v(this,m,xe).call(this),f(this,_,t),!(re||N(this.options.enabled,n(this,d))===!1||!_e(n(this,_))||n(this,_)===0)&&f(this,A,setInterval(()=>{(this.options.refetchIntervalInBackground||Nt.isFocused())&&v(this,m,J).call(this)},n(this,_)))},pe=function(){v(this,m,fe).call(this),v(this,m,ge).call(this,v(this,m,me).call(this))},ye=function(){n(this,P)&&(clearTimeout(n(this,P)),f(this,P,void 0))},xe=function(){n(this,A)&&(clearInterval(n(this,A)),f(this,A,void 0))},ve=function(){const t=n(this,j).getQueryCache().build(n(this,j),this.options);if(t===n(this,d))return;const s=n(this,d);f(this,d,t),f(this,K,t.state),this.hasListeners()&&(s==null||s.removeObserver(this),t.addObserver(this))},st=function(t){tt.batch(()=>{t.listeners&&this.listeners.forEach(s=>{s(n(this,w))}),n(this,j).getQueryCache().notify({query:n(this,d),type:"observerResultsUpdated"})})},Qe);function Ft(e,t){return N(t.enabled,e)!==!1&&e.state.data===void 0&&!(e.state.status==="error"&&t.retryOnMount===!1)}function Pe(e,t){return Ft(e,t)||e.state.data!==void 0&&be(e,t,t.refetchOnMount)}function be(e,t,s){if(N(t.enabled,e)!==!1){const r=typeof s=="function"?s(e):s;return r==="always"||r!==!1&&Ce(e,t)}return!1}function Ae(e,t,s,r){return(e!==t||N(r.enabled,e)===!1)&&(!s.suspense||e.state.status!=="error")&&Ce(e,s)}function Ce(e,t){return N(t.enabled,e)!==!1&&e.isStaleByTime(se(t.staleTime,e))}function Pt(e,t){return!he(e.getCurrentResult(),t)}var At=L.createContext(void 0),Tt=e=>{const t=L.useContext(At);if(!t)throw new Error("No QueryClient set, use QueryClientProvider to set one");return t},rt=L.createContext(!1),It=()=>L.useContext(rt);rt.Provider;function Qt(){let e=!1;return{clearReset:()=>{e=!1},reset:()=>{e=!0},isReset:()=>e}}var Ut=L.createContext(Qt()),qt=()=>L.useContext(Ut);function $t(e,t){return typeof e=="function"?e(...t):!!e}var Bt=(e,t)=>{(e.suspense||e.throwOnError)&&(t.isReset()||(e.retryOnMount=!1))},Ht=e=>{L.useEffect(()=>{e.clearReset()},[e])},Vt=({result:e,errorResetBoundary:t,throwOnError:s,query:r})=>e.isError&&!t.isReset()&&!e.isFetching&&r&&$t(s,[e.error,r]),zt=e=>{e.suspense&&(typeof e.staleTime!="number"&&(e.staleTime=1e3),typeof e.gcTime=="number"&&(e.gcTime=Math.max(e.gcTime,1e3)))},Wt=(e,t)=>(e==null?void 0:e.suspense)&&t.isPending,Yt=(e,t,s)=>t.fetchOptimistic(e).catch(()=>{s.clearReset()});function Jt(e,t,s){var x,u,g,D;const r=Tt(),a=It(),c=qt(),l=r.defaultQueryOptions(e);(u=(x=r.getDefaultOptions().queries)==null?void 0:x._experimental_beforeQuery)==null||u.call(x,l),l._optimisticResults=a?"isRestoring":"optimistic",zt(l),Bt(l,c),Ht(c);const[o]=L.useState(()=>new t(r,l)),h=o.getOptimisticResult(l);if(L.useSyncExternalStore(L.useCallback(C=>{const X=a?()=>{}:o.subscribe(tt.batchCalls(C));return o.updateResult(),X},[o,a]),()=>o.getCurrentResult(),()=>o.getCurrentResult()),L.useEffect(()=>{o.setOptions(l,{listeners:!1})},[l,o]),Wt(l,h))throw Yt(l,o,c);if(Vt({result:h,errorResetBoundary:c,throwOnError:l.throwOnError,query:r.getQueryCache().get(l.queryHash)}))throw h.error;return(D=(g=r.getDefaultOptions().queries)==null?void 0:g._experimental_afterQuery)==null||D.call(g,l,h),l.notifyOnChangeProps?h:o.trackResult(h)}function it(e,t){return Jt(e,kt)}function nt({documents:e}){return e.length===0?i.jsx("div",{className:"text-center py-6 text-muted-foreground",children:"No documents found"}):i.jsxs(ht,{children:[i.jsx(ft,{children:i.jsxs(Me,{children:[i.jsx(ue,{children:"Document"}),i.jsx(ue,{children:"Status"}),i.jsx(ue,{children:"Date"})]})}),i.jsx(mt,{children:e.map(t=>i.jsxs(Me,{children:[i.jsx(de,{children:t.title}),i.jsx(de,{children:i.jsx(gt,{variant:t.status==="signed"?"secondary":"default",children:t.status})}),i.jsx(de,{children:pt(new Date(t.created_at),"MMM d, yyyy")})]},t.id))})]})}nt.__docgenInfo={description:"",methods:[],displayName:"DocumentsList",props:{documents:{required:!0,tsType:{name:"Array",elements:[{name:"Document"}],raw:"Document[]"},description:""}}};function at(){const{profile:e}=Ke(),t=yt();return i.jsxs(T,{children:[i.jsx(I,{children:i.jsx(Q,{children:"Profile Information"})}),i.jsxs(U,{className:"space-y-4",children:[i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsx("div",{className:"h-16 w-16 rounded-full bg-primary/10 flex items-center justify-center",children:i.jsx(Ct,{className:"h-8 w-8 text-primary"})}),i.jsxs("div",{children:[i.jsxs("h3",{className:"font-semibold",children:[e==null?void 0:e.first_name," ",e==null?void 0:e.last_name]}),i.jsx("p",{className:"text-sm text-muted-foreground",children:e==null?void 0:e.email})]})]}),i.jsxs("div",{className:"grid gap-2 text-sm",children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-medium",children:"Phone: "}),(e==null?void 0:e.phone)||"Not provided"]}),i.jsxs("div",{className:"pt-2",children:[i.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground mb-1",children:[i.jsx(Ge,{className:"h-4 w-4"}),i.jsx("span",{className:"font-medium",children:"Agreement Status:"})]}),i.jsxs("div",{className:"ml-6",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("div",{className:"h-2 w-2 rounded-full bg-green-500"}),i.jsx("span",{children:"Sales Agent Agreement: Complete"})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("div",{className:"h-2 w-2 rounded-full bg-green-500"}),i.jsx("span",{children:"ACH Authorization: Complete"})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("div",{className:"h-2 w-2 rounded-full bg-green-500"}),i.jsx("span",{children:"Personal Guarantee: Complete"})]})]})]})]})]}),i.jsx(xt,{children:i.jsx(we,{variant:"outline",onClick:()=>t("/agent/profile"),className:"w-full",children:"Edit Profile"})})]})}at.__docgenInfo={description:"",methods:[],displayName:"ProfileOverview"};function ot(){const e=[{name:"IrisCRM Login",url:"https://iriscrm.com/login",description:"Access client management system"},{name:"ADP Login",url:"https://workforcenow.adp.com/",description:"Access payroll and HR portal"},{name:"Internal Email",url:"https://mail.irelandpay.com",description:"Access your company email"}];return i.jsxs(T,{children:[i.jsx(I,{children:i.jsx(Q,{children:"Quick Links"})}),i.jsx(U,{className:"space-y-4",children:e.map((t,s)=>i.jsxs("div",{className:"flex flex-col space-y-1",children:[i.jsxs(we,{variant:"outline",className:"justify-between w-full",onClick:()=>window.open(t.url,"_blank"),children:[t.name,i.jsx(jt,{className:"h-4 w-4 ml-2"})]}),i.jsx("p",{className:"text-xs text-muted-foreground",children:t.description})]},s))})]})}ot.__docgenInfo={description:"",methods:[],displayName:"ExternalLinks"};function ct(){const{user:e}=Ke(),{data:t,isLoading:s}=it({queryKey:["signed-agreements"],queryFn:async()=>{if(!e)return[];const{data:a,error:c}=await Xe.from("executed_agreements").select("*").eq("user_id",e.id).eq("status","signed").order("signed_at",{ascending:!1});if(c)throw c;return a},enabled:!!e}),r=(a,c)=>{alert(`Downloading PDF for agreement: ${c}`)};return s?i.jsxs(T,{children:[i.jsx(I,{children:i.jsx(Q,{children:"Executed Agreements"})}),i.jsx(U,{children:i.jsx("div",{className:"flex items-center justify-center h-32 text-muted-foreground",children:"Loading agreements..."})})]}):!t||t.length===0?i.jsxs(T,{children:[i.jsx(I,{children:i.jsx(Q,{children:"Executed Agreements"})}),i.jsx(U,{children:i.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[i.jsx(Ge,{className:"mx-auto h-12 w-12 opacity-50 mb-2"}),i.jsx("p",{children:"No signed agreements found"})]})})]}):i.jsxs(T,{children:[i.jsx(I,{children:i.jsx(Q,{children:"Executed Agreements"})}),i.jsx(U,{children:i.jsx("div",{className:"space-y-4",children:t.map(a=>i.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-md",children:[i.jsxs("div",{children:[i.jsx("h4",{className:"font-medium",children:a.title}),i.jsxs("p",{className:"text-sm text-muted-foreground",children:["Signed: ",new Date(a.signed_at).toLocaleDateString()]})]}),i.jsxs(we,{size:"sm",variant:"outline",onClick:()=>r(a.id,a.title),children:[i.jsx(vt,{className:"h-4 w-4 mr-1"})," Download PDF"]})]},a.id))})})]})}ct.__docgenInfo={description:"",methods:[],displayName:"DocumentDownload"};function ie(){const{data:e,isLoading:t}=it({queryKey:["executed-agreements"],queryFn:async()=>{const{data:s,error:r}=await Xe.from("executed_agreements").select("*").order("created_at",{ascending:!1});if(r)throw r;return s}});return i.jsx(bt,{children:i.jsxs("div",{className:"space-y-6",children:[i.jsx("h1",{className:"text-3xl font-bold",children:"Sales Agent Dashboard"}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[i.jsxs("div",{className:"md:col-span-1",children:[i.jsx(at,{}),i.jsx("div",{className:"mt-6",children:i.jsx(ot,{})})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsxs(T,{className:"mb-6",children:[i.jsx(I,{children:i.jsx(Q,{children:"Recent Activity"})}),i.jsx(U,{children:t?i.jsx("div",{className:"flex items-center justify-center h-32 text-muted-foreground",children:"Loading documents..."}):i.jsx(nt,{documents:e||[]})})]}),i.jsx(ct,{})]})]})]})})}ie.__docgenInfo={description:"",methods:[],displayName:"AgentDashboard"};const Kt=Ze((e,t)=>({auth:{user:null,profile:null,isLoading:!0,isAuthenticated:!1,error:null},notifications:{notifications:[],unreadCount:0},login:async(s,r)=>{e(a=>({auth:{...a.auth,isLoading:!0,error:null}}));try{const{data:a,error:c}=await b.auth.signInWithPassword({email:s,password:r});if(c)throw c;const{data:l}=await b.from("profiles").select("*").eq("id",a.user.id).single();e(o=>({auth:{...o.auth,user:a.user,profile:l,isAuthenticated:!0,isLoading:!1}})),y.success("Logged in successfully")}catch(a){e(c=>({auth:{...c.auth,error:a.message,isLoading:!1}})),y.error(`Login failed: ${a.message}`)}},logout:async()=>{e(s=>({auth:{...s.auth,isLoading:!0}}));try{await b.auth.signOut(),e(s=>({auth:{...s.auth,user:null,profile:null,isAuthenticated:!1,isLoading:!1}})),y.success("Logged out successfully")}catch(s){e(r=>({auth:{...r.auth,error:s.message,isLoading:!1}})),y.error(`Logout failed: ${s.message}`)}},resetPassword:async s=>{e(r=>({auth:{...r.auth,isLoading:!0,error:null}}));try{const{error:r}=await b.auth.resetPasswordForEmail(s,{redirectTo:`${window.location.origin}/reset-password-confirm`});if(r)throw r;e(a=>({auth:{...a.auth,isLoading:!1}})),y.success("Password reset email sent")}catch(r){e(a=>({auth:{...a.auth,error:r.message,isLoading:!1}})),y.error(`Password reset failed: ${r.message}`)}},updateProfile:async s=>{const{auth:r}=t();if(!r.user){y.error("You must be logged in to update your profile");return}try{const{error:a}=await b.from("profiles").update(s).eq("id",r.user.id);if(a)throw a;await t().refreshProfile(),y.success("Profile updated successfully")}catch(a){y.error(`Profile update failed: ${a.message}`)}},refreshProfile:async()=>{const{auth:s}=t();if(s.user)try{const{data:r,error:a}=await b.from("profiles").select("*").eq("id",s.user.id).single();if(a)throw a;e(c=>({auth:{...c.auth,profile:r}}))}catch(r){y.error(`Failed to refresh profile: ${r.message}`)}},addNotification:s=>{const r={...s,id:crypto.randomUUID(),read:!1,createdAt:new Date};e(a=>({notifications:{notifications:[r,...a.notifications.notifications].slice(0,100),unreadCount:a.notifications.unreadCount+1}})),y[s.type||"info"](s.message)},markNotificationAsRead:s=>{e(r=>{const a=r.notifications.notifications.map(l=>l.id===s?{...l,read:!0}:l),c=a.filter(l=>!l.read).length;return{notifications:{notifications:a,unreadCount:c}}})},markAllNotificationsAsRead:()=>{e(s=>({notifications:{notifications:s.notifications.notifications.map(r=>({...r,read:!0})),unreadCount:0}}))},clearNotifications:()=>{e({notifications:{notifications:[],unreadCount:0}})}})),Gt=Ze((e,t)=>({modules:[],materials:[],completions:[],certificates:[],currentModule:null,currentMaterial:null,isLoading:!1,isLoadingModule:!1,isLoadingMaterial:!1,isSubmitting:!1,error:null,fetchModules:async()=>{e({isLoading:!0,error:null});try{const{data:s,error:r}=await b.from("training_modules").select("*").order("order",{ascending:!0});if(r)throw r;const{data:a,error:c}=await b.from("training_materials").select("*").order("order",{ascending:!0});if(c)throw c;const l=s.map(o=>({...o,materials:a.filter(h=>h.module_id===o.id)}));e({modules:l,materials:a,isLoading:!1})}catch(s){console.error("Error fetching training modules:",s.message),e({error:s.message,isLoading:!1}),y.error(`Failed to load training modules: ${s.message}`)}},fetchModuleDetails:async s=>{e({isLoadingModule:!0,error:null});try{const{data:r,error:a}=await b.from("training_modules").select("*").eq("id",s).single();if(a)throw a;const{data:c,error:l}=await b.from("training_materials").select("*").eq("module_id",s).order("order",{ascending:!0});if(l)throw l;const o={...r,materials:c};return e({currentModule:o,isLoadingModule:!1}),o}catch(r){return console.error("Error fetching module details:",r.message),e({error:r.message,isLoadingModule:!1}),y.error(`Failed to load module details: ${r.message}`),null}},fetchMaterialDetails:async s=>{e({isLoadingMaterial:!0,error:null});try{const{data:r,error:a}=await b.from("training_materials").select("*").eq("id",s).single();if(a)throw a;return e({currentMaterial:r,isLoadingMaterial:!1}),r}catch(r){return console.error("Error fetching material details:",r.message),e({error:r.message,isLoadingMaterial:!1}),y.error(`Failed to load material details: ${r.message}`),null}},fetchCompletions:async()=>{e({isLoading:!0,error:null});try{const{data:s,error:r}=await b.from("training_completions").select("*").order("completed_at",{ascending:!1});if(r)throw r;return e({completions:s,isLoading:!1}),s}catch(s){return console.error("Error fetching completions:",s.message),e({error:s.message,isLoading:!1}),y.error(`Failed to load training completions: ${s.message}`),[]}},fetchCertificates:async()=>{e({isLoading:!0,error:null});try{const{data:s,error:r}=await b.from("training_certificates").select("*").order("issued_at",{ascending:!1});if(r)throw r;return e({certificates:s,isLoading:!1}),s}catch(s){return console.error("Error fetching certificates:",s.message),e({error:s.message,isLoading:!1}),y.error(`Failed to load certificates: ${s.message}`),[]}},markMaterialComplete:async(s,r)=>{e({isSubmitting:!0,error:null});try{const{data:{session:a}}=await b.auth.getSession(),c=a==null?void 0:a.user;if(!c)throw new Error("You must be logged in to complete training materials");const{data:l}=await b.from("training_completions").select("id").eq("user_id",c.id).eq("material_id",s).single();if(l){e({isSubmitting:!1});return}const{error:o}=await b.from("training_completions").insert({user_id:c.id,material_id:s,module_id:r});if(o)throw o;await t().fetchCompletions(),t().getModuleStatus(r)==="completed"?(y.success("Module completed! You can now download your certificate."),t().modules.filter(u=>u.required).every(u=>t().getModuleStatus(u.id)==="completed")&&y.success("All required training completed! Certificate is available.")):y.success("Material completed successfully!"),e({isSubmitting:!1})}catch(a){console.error("Error marking material complete:",a.message),e({error:a.message,isSubmitting:!1}),y.error(`Failed to mark material as complete: ${a.message}`)}},generateCertificate:async s=>{e({isSubmitting:!0,error:null});try{const{data:{session:r}}=await b.auth.getSession(),a=r==null?void 0:r.user;if(!a)throw new Error("You must be logged in to generate certificates");if(t().getModuleStatus(s)!=="completed")throw new Error("You must complete all materials in this module first");const{data:l}=await b.from("training_certificates").select("*").eq("user_id",a.id).eq("module_id",s).single();if(l)return e({isSubmitting:!1}),l.certificate_path;const o=t().modules.find(D=>D.id===s);if(!o)throw new Error("Module not found");let h=null;o.expiry_days&&(h=new Date,h.setDate(h.getDate()+o.expiry_days));const x=`certificates/${a.id}/${s}_${Date.now()}.pdf`,{data:u,error:g}=await b.from("training_certificates").insert({user_id:a.id,module_id:s,expires_at:(h==null?void 0:h.toISOString())||null,certificate_path:x}).select().single();if(g)throw g;return await t().fetchCertificates(),y.success("Certificate generated successfully!"),e({isSubmitting:!1}),x}catch(r){return console.error("Error generating certificate:",r.message),e({error:r.message,isSubmitting:!1}),y.error(`Failed to generate certificate: ${r.message}`),null}},getCompletionPercentage:s=>{var h,x;const{completions:r,materials:a}=t();let c="guest";try{const u=JSON.parse(localStorage.getItem("supabase.auth.token")||"{}");c=((x=(h=u==null?void 0:u.currentSession)==null?void 0:h.user)==null?void 0:x.id)||"guest"}catch(u){console.error("Error parsing auth session:",u)}if(c==="guest")return 0;const l=a.filter(u=>u.module_id===s);return l.length===0?0:r.filter(u=>u.module_id===s&&u.user_id===c).length/l.length*100},getModuleStatus:s=>{const r=t().getCompletionPercentage(s);return r===0?"not-started":r===100?"completed":"in-progress"},resetCurrentModule:()=>{e({currentModule:null})},resetCurrentMaterial:()=>{e({currentMaterial:null})}})),lt={user:{id:"123",email:"agent@example.com",fullName:"Agent User",roles:["agent"]},isAuthenticated:!0,isLoading:!1},ut={trainingModules:[{id:"1",title:"Getting Started",description:"Introduction to the platform",status:"active",materials:[{id:"101",title:"Welcome",isCompleted:!0},{id:"102",title:"Basic Navigation",isCompleted:!1}]}],getCompletionPercentage:()=>50,isCertified:()=>!1,fetchTrainingModules:()=>Promise.resolve(),fetchTrainingCompletions:()=>Promise.resolve()};Y.mock("../../state/store",async()=>({...await Y.importActual("../../state/store"),useStore:()=>lt}));Y.mock("../../state/trainingStore",async()=>({...await Y.importActual("../../state/trainingStore"),useTrainingStore:()=>ut}));const ns={title:"Pages/Agent/Dashboard",component:ie,parameters:{layout:"fullscreen"},decorators:[e=>i.jsx(wt,{children:i.jsx(e,{})})]},Z={args:{}},ee={parameters:{mockData:{isLoading:!0}},render:()=>(Y.mocked(Kt).mockReturnValue({...lt,isLoading:!0}),i.jsx(ie,{}))},te={parameters:{mockData:{isCertified:!0,completionPercentage:100}},render:()=>(Y.mocked(Gt).mockReturnValue({...ut,getCompletionPercentage:()=>100,isCertified:()=>!0}),i.jsx(ie,{}))};var Ue,qe,$e;Z.parameters={...Z.parameters,docs:{...(Ue=Z.parameters)==null?void 0:Ue.docs,source:{originalSource:`{
  args: {}
}`,...($e=(qe=Z.parameters)==null?void 0:qe.docs)==null?void 0:$e.source}}};var Be,He,Ve;ee.parameters={...ee.parameters,docs:{...(Be=ee.parameters)==null?void 0:Be.docs,source:{originalSource:`{
  parameters: {
    mockData: {
      isLoading: true
    }
  },
  render: () => {
    // Override the mock for this specific story
    vi.mocked(storeModule.useStore).mockReturnValue({
      ...mockStore,
      isLoading: true
    });
    return <Dashboard />;
  }
}`,...(Ve=(He=ee.parameters)==null?void 0:He.docs)==null?void 0:Ve.source}}};var ze,We,Ye;te.parameters={...te.parameters,docs:{...(ze=te.parameters)==null?void 0:ze.docs,source:{originalSource:`{
  parameters: {
    mockData: {
      isCertified: true,
      completionPercentage: 100
    }
  },
  render: () => {
    // Override the mock for this specific story
    vi.mocked(trainingStoreModule.useTrainingStore).mockReturnValue({
      ...mockTrainingStore,
      getCompletionPercentage: () => 100,
      isCertified: () => true
    });
    return <Dashboard />;
  }
}`,...(Ye=(We=te.parameters)==null?void 0:We.docs)==null?void 0:Ye.source}}};const as=["Default","Loading","Certified"];export{te as Certified,Z as Default,ee as Loading,as as __namedExportsOrder,ns as default};
