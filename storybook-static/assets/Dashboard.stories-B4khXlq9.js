var ke=e=>{throw TypeError(e)};var ge=(e,t,s)=>t.has(e)||ke("Cannot "+s);var a=(e,t,s)=>(ge(e,t,"read from private field"),s?s.call(e):t.get(e)),y=(e,t,s)=>t.has(e)?ke("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,s),h=(e,t,s,r)=>(ge(e,t,"write to private field"),r?r.call(e,s):t.set(e,s),s),b=(e,t,s)=>(ge(e,t,"access private method"),s);import{j as n}from"./jsx-runtime-CiKstLBL.js";import{r as R}from"./index-CoXXcpNP.js";import{c as rt,T as bt,a as vt,b as Pe,d as pe,e as wt,f as ye,B as jt,g as Ct,u as it,h as St,C as q,i as U,j as $,k as B,F as nt,l as Lt,m as Ee,D as Rt,s as at,M as Et,n as ot,o as x,p as w,q as Nt,v as J}from"./vi.ClIskdbk-B47bHBmX.js";import"./index-S3NOQ7Fp.js";import"./iframe-Cp77XSgM.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mt=rt("ExternalLink",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _t=rt("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);var Ne=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(e){return this.listeners.add(e),this.onSubscribe(),()=>{this.listeners.delete(e),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},te=typeof window>"u"||"Deno"in globalThis;function Dt(){}function Fe(e){return typeof e=="number"&&e>=0&&e!==1/0}function Ot(e,t){return Math.max(e+(t||0)-Date.now(),0)}function ue(e,t){return typeof e=="function"?e(t):e}function N(e,t){return typeof e=="function"?e(t):e}function ct(e,t){if(e===t)return e;const s=Te(e)&&Te(t);if(s||Ae(e)&&Ae(t)){const r=s?e:Object.keys(e),i=r.length,o=s?t:Object.keys(t),c=o.length,l=s?[]:{};let u=0;for(let p=0;p<c;p++){const f=s?p:o[p];(!s&&r.includes(f)||s)&&e[f]===void 0&&t[f]===void 0?(l[f]=void 0,u++):(l[f]=ct(e[f],t[f]),l[f]===e[f]&&e[f]!==void 0&&u++)}return i===c&&u===i?e:l}return t}function xe(e,t){if(!t||Object.keys(e).length!==Object.keys(t).length)return!1;for(const s in e)if(e[s]!==t[s])return!1;return!0}function Te(e){return Array.isArray(e)&&e.length===Object.keys(e).length}function Ae(e){if(!Ie(e))return!1;const t=e.constructor;if(t===void 0)return!0;const s=t.prototype;return!(!Ie(s)||!s.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(e)!==Object.prototype)}function Ie(e){return Object.prototype.toString.call(e)==="[object Object]"}function Qe(e,t,s){return typeof s.structuralSharing=="function"?s.structuralSharing(e,t):s.structuralSharing!==!1?ct(e,t):t}var F,M,H,ze,kt=(ze=class extends Ne{constructor(){super();y(this,F);y(this,M);y(this,H);h(this,H,t=>{if(!te&&window.addEventListener){const s=()=>t();return window.addEventListener("visibilitychange",s,!1),()=>{window.removeEventListener("visibilitychange",s)}}})}onSubscribe(){a(this,M)||this.setEventListener(a(this,H))}onUnsubscribe(){var t;this.hasListeners()||((t=a(this,M))==null||t.call(this),h(this,M,void 0))}setEventListener(t){var s;h(this,H,t),(s=a(this,M))==null||s.call(this),h(this,M,t(r=>{typeof r=="boolean"?this.setFocused(r):this.onFocus()}))}setFocused(t){a(this,F)!==t&&(h(this,F,t),this.onFocus())}onFocus(){const t=this.isFocused();this.listeners.forEach(s=>{s(t)})}isFocused(){var t;return typeof a(this,F)=="boolean"?a(this,F):((t=globalThis.document)==null?void 0:t.visibilityState)!=="hidden"}},F=new WeakMap,M=new WeakMap,H=new WeakMap,ze),Pt=new kt,z,_,V,Ve,Ft=(Ve=class extends Ne{constructor(){super();y(this,z,!0);y(this,_);y(this,V);h(this,V,t=>{if(!te&&window.addEventListener){const s=()=>t(!0),r=()=>t(!1);return window.addEventListener("online",s,!1),window.addEventListener("offline",r,!1),()=>{window.removeEventListener("online",s),window.removeEventListener("offline",r)}}})}onSubscribe(){a(this,_)||this.setEventListener(a(this,V))}onUnsubscribe(){var t;this.hasListeners()||((t=a(this,_))==null||t.call(this),h(this,_,void 0))}setEventListener(t){var s;h(this,V,t),(s=a(this,_))==null||s.call(this),h(this,_,t(this.setOnline.bind(this)))}setOnline(t){a(this,z)!==t&&(h(this,z,t),this.listeners.forEach(r=>{r(t)}))}isOnline(){return a(this,z)}},z=new WeakMap,_=new WeakMap,V=new WeakMap,Ve),Tt=new Ft;function qe(){let e,t;const s=new Promise((i,o)=>{e=i,t=o});s.status="pending",s.catch(()=>{});function r(i){Object.assign(s,i),delete s.resolve,delete s.reject}return s.resolve=i=>{r({status:"fulfilled",value:i}),e(i)},s.reject=i=>{r({status:"rejected",reason:i}),t(i)},s}function At(e){return(e??"online")==="online"?Tt.isOnline():!0}var It=e=>setTimeout(e,0);function Qt(){let e=[],t=0,s=l=>{l()},r=l=>{l()},i=It;const o=l=>{t?e.push(l):i(()=>{s(l)})},c=()=>{const l=e;e=[],l.length&&i(()=>{r(()=>{l.forEach(u=>{s(u)})})})};return{batch:l=>{let u;t++;try{u=l()}finally{t--,t||c()}return u},batchCalls:l=>(...u)=>{o(()=>{l(...u)})},schedule:o,setNotifyFunction:l=>{s=l},setBatchNotifyFunction:l=>{r=l},setScheduler:l=>{i=l}}}var lt=Qt();function qt(e,t){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:At(t.networkMode)?"fetching":"paused",...e===void 0&&{error:null,status:"pending"}}}var C,d,se,j,T,W,D,O,re,Y,K,A,I,k,G,m,ee,be,ve,we,je,Ce,Se,Le,ut,We,Ut=(We=class extends Ne{constructor(t,s){super();y(this,m);y(this,C);y(this,d);y(this,se);y(this,j);y(this,T);y(this,W);y(this,D);y(this,O);y(this,re);y(this,Y);y(this,K);y(this,A);y(this,I);y(this,k);y(this,G,new Set);this.options=s,h(this,C,t),h(this,O,null),h(this,D,qe()),this.options.experimental_prefetchInRender||a(this,D).reject(new Error("experimental_prefetchInRender feature flag is not enabled")),this.bindMethods(),this.setOptions(s)}bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(a(this,d).addObserver(this),Ue(a(this,d),this.options)?b(this,m,ee).call(this):this.updateResult(),b(this,m,je).call(this))}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return Re(a(this,d),this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return Re(a(this,d),this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,b(this,m,Ce).call(this),b(this,m,Se).call(this),a(this,d).removeObserver(this)}setOptions(t){const s=this.options,r=a(this,d);if(this.options=a(this,C).defaultQueryOptions(t),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof N(this.options.enabled,a(this,d))!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");b(this,m,Le).call(this),a(this,d).setOptions(this.options),s._defaulted&&!xe(this.options,s)&&a(this,C).getQueryCache().notify({type:"observerOptionsUpdated",query:a(this,d),observer:this});const i=this.hasListeners();i&&$e(a(this,d),r,this.options,s)&&b(this,m,ee).call(this),this.updateResult(),i&&(a(this,d)!==r||N(this.options.enabled,a(this,d))!==N(s.enabled,a(this,d))||ue(this.options.staleTime,a(this,d))!==ue(s.staleTime,a(this,d)))&&b(this,m,be).call(this);const o=b(this,m,ve).call(this);i&&(a(this,d)!==r||N(this.options.enabled,a(this,d))!==N(s.enabled,a(this,d))||o!==a(this,k))&&b(this,m,we).call(this,o)}getOptimisticResult(t){const s=a(this,C).getQueryCache().build(a(this,C),t),r=this.createResult(s,t);return Bt(this,r)&&(h(this,j,r),h(this,W,this.options),h(this,T,a(this,d).state)),r}getCurrentResult(){return a(this,j)}trackResult(t,s){return new Proxy(t,{get:(r,i)=>(this.trackProp(i),s==null||s(i),Reflect.get(r,i))})}trackProp(t){a(this,G).add(t)}getCurrentQuery(){return a(this,d)}refetch({...t}={}){return this.fetch({...t})}fetchOptimistic(t){const s=a(this,C).defaultQueryOptions(t),r=a(this,C).getQueryCache().build(a(this,C),s);return r.fetch().then(()=>this.createResult(r,s))}fetch(t){return b(this,m,ee).call(this,{...t,cancelRefetch:t.cancelRefetch??!0}).then(()=>(this.updateResult(),a(this,j)))}createResult(t,s){var Oe;const r=a(this,d),i=this.options,o=a(this,j),c=a(this,T),l=a(this,W),p=t!==r?t.state:a(this,se),{state:f}=t;let g={...f},P=!1,v;if(s._optimisticResults){const L=this.hasListeners(),ne=!L&&Ue(t,s),Q=L&&$e(t,r,s,i);(ne||Q)&&(g={...g,...qt(f.data,t.options)}),s._optimisticResults==="isRestoring"&&(g.fetchStatus="idle")}let{error:X,errorUpdatedAt:Z,status:S}=g;v=g.data;let ie=!1;if(s.placeholderData!==void 0&&v===void 0&&S==="pending"){let L;o!=null&&o.isPlaceholderData&&s.placeholderData===(l==null?void 0:l.placeholderData)?(L=o.data,ie=!0):L=typeof s.placeholderData=="function"?s.placeholderData((Oe=a(this,K))==null?void 0:Oe.state.data,a(this,K)):s.placeholderData,L!==void 0&&(S="success",v=Qe(o==null?void 0:o.data,L,s),P=!0)}if(s.select&&v!==void 0&&!ie)if(o&&v===(c==null?void 0:c.data)&&s.select===a(this,re))v=a(this,Y);else try{h(this,re,s.select),v=s.select(v),v=Qe(o==null?void 0:o.data,v,s),h(this,Y,v),h(this,O,null)}catch(L){h(this,O,L)}a(this,O)&&(X=a(this,O),v=a(this,Y),Z=Date.now(),S="error");const he=g.fetchStatus==="fetching",fe=S==="pending",me=S==="error",_e=fe&&he,De=v!==void 0,E={status:S,fetchStatus:g.fetchStatus,isPending:fe,isSuccess:S==="success",isError:me,isInitialLoading:_e,isLoading:_e,data:v,dataUpdatedAt:g.dataUpdatedAt,error:X,errorUpdatedAt:Z,failureCount:g.fetchFailureCount,failureReason:g.fetchFailureReason,errorUpdateCount:g.errorUpdateCount,isFetched:g.dataUpdateCount>0||g.errorUpdateCount>0,isFetchedAfterMount:g.dataUpdateCount>p.dataUpdateCount||g.errorUpdateCount>p.errorUpdateCount,isFetching:he,isRefetching:he&&!fe,isLoadingError:me&&!De,isPaused:g.fetchStatus==="paused",isPlaceholderData:P,isRefetchError:me&&De,isStale:Me(t,s),refetch:this.refetch,promise:a(this,D)};if(this.options.experimental_prefetchInRender){const L=ae=>{E.status==="error"?ae.reject(E.error):E.data!==void 0&&ae.resolve(E.data)},ne=()=>{const ae=h(this,D,E.promise=qe());L(ae)},Q=a(this,D);switch(Q.status){case"pending":t.queryHash===r.queryHash&&L(Q);break;case"fulfilled":(E.status==="error"||E.data!==Q.value)&&ne();break;case"rejected":(E.status!=="error"||E.error!==Q.reason)&&ne();break}}return E}updateResult(){const t=a(this,j),s=this.createResult(a(this,d),this.options);if(h(this,T,a(this,d).state),h(this,W,this.options),a(this,T).data!==void 0&&h(this,K,a(this,d)),xe(s,t))return;h(this,j,s);const r=()=>{if(!t)return!0;const{notifyOnChangeProps:i}=this.options,o=typeof i=="function"?i():i;if(o==="all"||!o&&!a(this,G).size)return!0;const c=new Set(o??a(this,G));return this.options.throwOnError&&c.add("error"),Object.keys(a(this,j)).some(l=>{const u=l;return a(this,j)[u]!==t[u]&&c.has(u)})};b(this,m,ut).call(this,{listeners:r()})}onQueryUpdate(){this.updateResult(),this.hasListeners()&&b(this,m,je).call(this)}},C=new WeakMap,d=new WeakMap,se=new WeakMap,j=new WeakMap,T=new WeakMap,W=new WeakMap,D=new WeakMap,O=new WeakMap,re=new WeakMap,Y=new WeakMap,K=new WeakMap,A=new WeakMap,I=new WeakMap,k=new WeakMap,G=new WeakMap,m=new WeakSet,ee=function(t){b(this,m,Le).call(this);let s=a(this,d).fetch(this.options,t);return t!=null&&t.throwOnError||(s=s.catch(Dt)),s},be=function(){b(this,m,Ce).call(this);const t=ue(this.options.staleTime,a(this,d));if(te||a(this,j).isStale||!Fe(t))return;const r=Ot(a(this,j).dataUpdatedAt,t)+1;h(this,A,setTimeout(()=>{a(this,j).isStale||this.updateResult()},r))},ve=function(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(a(this,d)):this.options.refetchInterval)??!1},we=function(t){b(this,m,Se).call(this),h(this,k,t),!(te||N(this.options.enabled,a(this,d))===!1||!Fe(a(this,k))||a(this,k)===0)&&h(this,I,setInterval(()=>{(this.options.refetchIntervalInBackground||Pt.isFocused())&&b(this,m,ee).call(this)},a(this,k)))},je=function(){b(this,m,be).call(this),b(this,m,we).call(this,b(this,m,ve).call(this))},Ce=function(){a(this,A)&&(clearTimeout(a(this,A)),h(this,A,void 0))},Se=function(){a(this,I)&&(clearInterval(a(this,I)),h(this,I,void 0))},Le=function(){const t=a(this,C).getQueryCache().build(a(this,C),this.options);if(t===a(this,d))return;const s=a(this,d);h(this,d,t),h(this,se,t.state),this.hasListeners()&&(s==null||s.removeObserver(this),t.addObserver(this))},ut=function(t){lt.batch(()=>{t.listeners&&this.listeners.forEach(s=>{s(a(this,j))}),a(this,C).getQueryCache().notify({query:a(this,d),type:"observerResultsUpdated"})})},We);function $t(e,t){return N(t.enabled,e)!==!1&&e.state.data===void 0&&!(e.state.status==="error"&&t.retryOnMount===!1)}function Ue(e,t){return $t(e,t)||e.state.data!==void 0&&Re(e,t,t.refetchOnMount)}function Re(e,t,s){if(N(t.enabled,e)!==!1){const r=typeof s=="function"?s(e):s;return r==="always"||r!==!1&&Me(e,t)}return!1}function $e(e,t,s,r){return(e!==t||N(r.enabled,e)===!1)&&(!s.suspense||e.state.status!=="error")&&Me(e,s)}function Me(e,t){return N(t.enabled,e)!==!1&&e.isStaleByTime(ue(t.staleTime,e))}function Bt(e,t){return!xe(e.getCurrentResult(),t)}var Ht=R.createContext(void 0),zt=e=>{const t=R.useContext(Ht);if(!t)throw new Error("No QueryClient set, use QueryClientProvider to set one");return t},dt=R.createContext(!1),Vt=()=>R.useContext(dt);dt.Provider;function Wt(){let e=!1;return{clearReset:()=>{e=!1},reset:()=>{e=!0},isReset:()=>e}}var Yt=R.createContext(Wt()),Kt=()=>R.useContext(Yt);function Gt(e,t){return typeof e=="function"?e(...t):!!e}function Be(){}var Jt=(e,t)=>{(e.suspense||e.throwOnError||e.experimental_prefetchInRender)&&(t.isReset()||(e.retryOnMount=!1))},Xt=e=>{R.useEffect(()=>{e.clearReset()},[e])},Zt=({result:e,errorResetBoundary:t,throwOnError:s,query:r,suspense:i})=>e.isError&&!t.isReset()&&!e.isFetching&&r&&(i&&e.data===void 0||Gt(s,[e.error,r])),es=e=>{const t=e.staleTime;e.suspense&&(e.staleTime=typeof t=="function"?(...s)=>Math.max(t(...s),1e3):Math.max(t??1e3,1e3),typeof e.gcTime=="number"&&(e.gcTime=Math.max(e.gcTime,1e3)))},ts=(e,t)=>e.isLoading&&e.isFetching&&!t,ss=(e,t)=>(e==null?void 0:e.suspense)&&t.isPending,He=(e,t,s)=>t.fetchOptimistic(e).catch(()=>{s.clearReset()});function rs(e,t,s){var g,P,v,X,Z;const r=zt(),i=Vt(),o=Kt(),c=r.defaultQueryOptions(e);(P=(g=r.getDefaultOptions().queries)==null?void 0:g._experimental_beforeQuery)==null||P.call(g,c),c._optimisticResults=i?"isRestoring":"optimistic",es(c),Jt(c,o),Xt(o);const l=!r.getQueryCache().get(c.queryHash),[u]=R.useState(()=>new t(r,c)),p=u.getOptimisticResult(c),f=!i&&e.subscribed!==!1;if(R.useSyncExternalStore(R.useCallback(S=>{const ie=f?u.subscribe(lt.batchCalls(S)):Be;return u.updateResult(),ie},[u,f]),()=>u.getCurrentResult(),()=>u.getCurrentResult()),R.useEffect(()=>{u.setOptions(c)},[c,u]),ss(c,p))throw He(c,u,o);if(Zt({result:p,errorResetBoundary:o,throwOnError:c.throwOnError,query:r.getQueryCache().get(c.queryHash),suspense:c.suspense}))throw p.error;if((X=(v=r.getDefaultOptions().queries)==null?void 0:v._experimental_afterQuery)==null||X.call(v,c,p),c.experimental_prefetchInRender&&!te&&ts(p,i)){const S=l?He(c,u,o):(Z=r.getQueryCache().get(c.queryHash))==null?void 0:Z.promise;S==null||S.catch(Be).finally(()=>{u.updateResult()})}return c.notifyOnChangeProps?p:u.trackResult(p)}function ht(e,t){return rs(e,Ut)}function ft({documents:e}){return e.length===0?n.jsx("div",{className:"text-center py-6 text-muted-foreground",children:"No documents found"}):n.jsxs(bt,{children:[n.jsx(vt,{children:n.jsxs(Pe,{children:[n.jsx(pe,{children:"Document"}),n.jsx(pe,{children:"Status"}),n.jsx(pe,{children:"Date"})]})}),n.jsx(wt,{children:e.map(t=>n.jsxs(Pe,{children:[n.jsx(ye,{children:t.title}),n.jsx(ye,{children:n.jsx(jt,{variant:t.status==="signed"?"secondary":"default",children:t.status})}),n.jsx(ye,{children:Ct(new Date(t.created_at),"MMM d, yyyy")})]},t.id))})]})}ft.__docgenInfo={description:"",methods:[],displayName:"DocumentsList",props:{documents:{required:!0,tsType:{name:"Array",elements:[{name:"Document"}],raw:"Document[]"},description:""}}};function mt(){const{profile:e}=it(),t=St();return n.jsxs(q,{children:[n.jsx(U,{children:n.jsx($,{children:"Profile Information"})}),n.jsxs(B,{className:"space-y-4",children:[n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsx("div",{className:"h-16 w-16 rounded-full bg-primary/10 flex items-center justify-center",children:n.jsx(_t,{className:"h-8 w-8 text-primary"})}),n.jsxs("div",{children:[n.jsxs("h3",{className:"font-semibold",children:[e==null?void 0:e.first_name," ",e==null?void 0:e.last_name]}),n.jsx("p",{className:"text-sm text-muted-foreground",children:e==null?void 0:e.email})]})]}),n.jsxs("div",{className:"grid gap-2 text-sm",children:[n.jsxs("div",{children:[n.jsx("span",{className:"font-medium",children:"Phone: "}),(e==null?void 0:e.phone)||"Not provided"]}),n.jsxs("div",{className:"pt-2",children:[n.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground mb-1",children:[n.jsx(nt,{className:"h-4 w-4"}),n.jsx("span",{className:"font-medium",children:"Agreement Status:"})]}),n.jsxs("div",{className:"ml-6",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("div",{className:"h-2 w-2 rounded-full bg-green-500"}),n.jsx("span",{children:"Sales Agent Agreement: Complete"})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("div",{className:"h-2 w-2 rounded-full bg-green-500"}),n.jsx("span",{children:"ACH Authorization: Complete"})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("div",{className:"h-2 w-2 rounded-full bg-green-500"}),n.jsx("span",{children:"Personal Guarantee: Complete"})]})]})]})]})]}),n.jsx(Lt,{children:n.jsx(Ee,{variant:"outline",onClick:()=>t("/agent/profile"),className:"w-full",children:"Edit Profile"})})]})}mt.__docgenInfo={description:"",methods:[],displayName:"ProfileOverview"};function gt(){const e=[{name:"IrisCRM Login",url:"https://iriscrm.com/login",description:"Access client management system"},{name:"ADP Login",url:"https://workforcenow.adp.com/",description:"Access payroll and HR portal"},{name:"Internal Email",url:"https://mail.irelandpay.com",description:"Access your company email"}];return n.jsxs(q,{children:[n.jsx(U,{children:n.jsx($,{children:"Quick Links"})}),n.jsx(B,{className:"space-y-4",children:e.map((t,s)=>n.jsxs("div",{className:"flex flex-col space-y-1",children:[n.jsxs(Ee,{variant:"outline",className:"justify-between w-full",onClick:()=>window.open(t.url,"_blank"),children:[t.name,n.jsx(Mt,{className:"h-4 w-4 ml-2"})]}),n.jsx("p",{className:"text-xs text-muted-foreground",children:t.description})]},s))})]})}gt.__docgenInfo={description:"",methods:[],displayName:"ExternalLinks"};function pt(){const{user:e}=it(),{data:t,isLoading:s}=ht({queryKey:["signed-agreements"],queryFn:async()=>{if(!e)return[];const{data:i,error:o}=await at.from("executed_agreements").select("*").eq("user_id",e.id).eq("status","signed").order("signed_at",{ascending:!1});if(o)throw o;return i},enabled:!!e}),r=(i,o)=>{alert(`Downloading PDF for agreement: ${o}`)};return s?n.jsxs(q,{children:[n.jsx(U,{children:n.jsx($,{children:"Executed Agreements"})}),n.jsx(B,{children:n.jsx("div",{className:"flex items-center justify-center h-32 text-muted-foreground",children:"Loading agreements..."})})]}):!t||t.length===0?n.jsxs(q,{children:[n.jsx(U,{children:n.jsx($,{children:"Executed Agreements"})}),n.jsx(B,{children:n.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[n.jsx(nt,{className:"mx-auto h-12 w-12 opacity-50 mb-2"}),n.jsx("p",{children:"No signed agreements found"})]})})]}):n.jsxs(q,{children:[n.jsx(U,{children:n.jsx($,{children:"Executed Agreements"})}),n.jsx(B,{children:n.jsx("div",{className:"space-y-4",children:t.map(i=>n.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-md",children:[n.jsxs("div",{children:[n.jsx("h4",{className:"font-medium",children:i.title}),n.jsxs("p",{className:"text-sm text-muted-foreground",children:["Signed: ",new Date(i.signed_at).toLocaleDateString()]})]}),n.jsxs(Ee,{size:"sm",variant:"outline",onClick:()=>r(i.id,i.title),children:[n.jsx(Rt,{className:"h-4 w-4 mr-1"})," Download PDF"]})]},i.id))})})]})}pt.__docgenInfo={description:"",methods:[],displayName:"DocumentDownload"};function de(){const{data:e,isLoading:t}=ht({queryKey:["executed-agreements"],queryFn:async()=>{const{data:s,error:r}=await at.from("executed_agreements").select("*").order("created_at",{ascending:!1});if(r)throw r;return s}});return n.jsx(Et,{children:n.jsxs("div",{className:"space-y-6",children:[n.jsx("h1",{className:"text-3xl font-bold",children:"Sales Agent Dashboard"}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[n.jsxs("div",{className:"md:col-span-1",children:[n.jsx(mt,{}),n.jsx("div",{className:"mt-6",children:n.jsx(gt,{})})]}),n.jsxs("div",{className:"md:col-span-2",children:[n.jsxs(q,{className:"mb-6",children:[n.jsx(U,{children:n.jsx($,{children:"Recent Activity"})}),n.jsx(B,{children:t?n.jsx("div",{className:"flex items-center justify-center h-32 text-muted-foreground",children:"Loading documents..."}):n.jsx(ft,{documents:e||[]})})]}),n.jsx(pt,{})]})]})]})})}de.__docgenInfo={description:"",methods:[],displayName:"AgentDashboard"};const is=ot((e,t)=>({auth:{user:null,profile:null,isLoading:!0,isAuthenticated:!1,error:null},notifications:{notifications:[],unreadCount:0},login:async(s,r)=>{e(i=>({auth:{...i.auth,isLoading:!0,error:null}}));try{const{data:i,error:o}=await w.auth.signInWithPassword({email:s,password:r});if(o)throw o;const{data:c}=await w.from("profiles").select("*").eq("id",i.user.id).single();e(l=>({auth:{...l.auth,user:i.user,profile:c,isAuthenticated:!0,isLoading:!1}})),x.success("Logged in successfully")}catch(i){e(o=>({auth:{...o.auth,error:i.message,isLoading:!1}})),x.error(`Login failed: ${i.message}`)}},logout:async()=>{e(s=>({auth:{...s.auth,isLoading:!0}}));try{await w.auth.signOut(),e(s=>({auth:{...s.auth,user:null,profile:null,isAuthenticated:!1,isLoading:!1}})),x.success("Logged out successfully")}catch(s){e(r=>({auth:{...r.auth,error:s.message,isLoading:!1}})),x.error(`Logout failed: ${s.message}`)}},resetPassword:async s=>{e(r=>({auth:{...r.auth,isLoading:!0,error:null}}));try{const{error:r}=await w.auth.resetPasswordForEmail(s,{redirectTo:`${window.location.origin}/reset-password-confirm`});if(r)throw r;e(i=>({auth:{...i.auth,isLoading:!1}})),x.success("Password reset email sent")}catch(r){e(i=>({auth:{...i.auth,error:r.message,isLoading:!1}})),x.error(`Password reset failed: ${r.message}`)}},updateProfile:async s=>{const{auth:r}=t();if(!r.user){x.error("You must be logged in to update your profile");return}try{const{error:i}=await w.from("profiles").update(s).eq("id",r.user.id);if(i)throw i;await t().refreshProfile(),x.success("Profile updated successfully")}catch(i){x.error(`Profile update failed: ${i.message}`)}},refreshProfile:async()=>{const{auth:s}=t();if(s.user)try{const{data:r,error:i}=await w.from("profiles").select("*").eq("id",s.user.id).single();if(i)throw i;e(o=>({auth:{...o.auth,profile:r}}))}catch(r){x.error(`Failed to refresh profile: ${r.message}`)}},addNotification:s=>{const r={...s,id:crypto.randomUUID(),read:!1,createdAt:new Date};e(i=>({notifications:{notifications:[r,...i.notifications.notifications].slice(0,100),unreadCount:i.notifications.unreadCount+1}})),x[s.type||"info"](s.message)},markNotificationAsRead:s=>{e(r=>{const i=r.notifications.notifications.map(c=>c.id===s?{...c,read:!0}:c),o=i.filter(c=>!c.read).length;return{notifications:{notifications:i,unreadCount:o}}})},markAllNotificationsAsRead:()=>{e(s=>({notifications:{notifications:s.notifications.notifications.map(r=>({...r,read:!0})),unreadCount:0}}))},clearNotifications:()=>{e({notifications:{notifications:[],unreadCount:0}})}})),ns=ot((e,t)=>({modules:[],materials:[],completions:[],certificates:[],currentModule:null,currentMaterial:null,isLoading:!1,isLoadingModule:!1,isLoadingMaterial:!1,isSubmitting:!1,error:null,fetchModules:async()=>{e({isLoading:!0,error:null});try{const{data:s,error:r}=await w.from("training_modules").select("*").order("order",{ascending:!0});if(r)throw r;const{data:i,error:o}=await w.from("training_materials").select("*").order("order",{ascending:!0});if(o)throw o;const c=s.map(l=>({...l,materials:i.filter(u=>u.module_id===l.id)}));e({modules:c,materials:i,isLoading:!1})}catch(s){console.error("Error fetching training modules:",s.message),e({error:s.message,isLoading:!1}),x.error(`Failed to load training modules: ${s.message}`)}},fetchModuleDetails:async s=>{e({isLoadingModule:!0,error:null});try{const{data:r,error:i}=await w.from("training_modules").select("*").eq("id",s).single();if(i)throw i;const{data:o,error:c}=await w.from("training_materials").select("*").eq("module_id",s).order("order",{ascending:!0});if(c)throw c;const l={...r,materials:o};return e({currentModule:l,isLoadingModule:!1}),l}catch(r){return console.error("Error fetching module details:",r.message),e({error:r.message,isLoadingModule:!1}),x.error(`Failed to load module details: ${r.message}`),null}},fetchMaterialDetails:async s=>{e({isLoadingMaterial:!0,error:null});try{const{data:r,error:i}=await w.from("training_materials").select("*").eq("id",s).single();if(i)throw i;return e({currentMaterial:r,isLoadingMaterial:!1}),r}catch(r){return console.error("Error fetching material details:",r.message),e({error:r.message,isLoadingMaterial:!1}),x.error(`Failed to load material details: ${r.message}`),null}},fetchCompletions:async()=>{e({isLoading:!0,error:null});try{const{data:s,error:r}=await w.from("training_completions").select("*").order("completed_at",{ascending:!1});if(r)throw r;return e({completions:s,isLoading:!1}),s}catch(s){return console.error("Error fetching completions:",s.message),e({error:s.message,isLoading:!1}),x.error(`Failed to load training completions: ${s.message}`),[]}},fetchCertificates:async()=>{e({isLoading:!0,error:null});try{const{data:s,error:r}=await w.from("training_certificates").select("*").order("issued_at",{ascending:!1});if(r)throw r;return e({certificates:s,isLoading:!1}),s}catch(s){return console.error("Error fetching certificates:",s.message),e({error:s.message,isLoading:!1}),x.error(`Failed to load certificates: ${s.message}`),[]}},markMaterialComplete:async(s,r)=>{e({isSubmitting:!0,error:null});try{const{data:{session:i}}=await w.auth.getSession(),o=i==null?void 0:i.user;if(!o)throw new Error("You must be logged in to complete training materials");const{data:c}=await w.from("training_completions").select("id").eq("user_id",o.id).eq("material_id",s).single();if(c){e({isSubmitting:!1});return}const{error:l}=await w.from("training_completions").insert({user_id:o.id,material_id:s,module_id:r});if(l)throw l;await t().fetchCompletions(),t().getModuleStatus(r)==="completed"?(x.success("Module completed! You can now download your certificate."),t().modules.filter(f=>f.required).every(f=>t().getModuleStatus(f.id)==="completed")&&x.success("All required training completed! Certificate is available.")):x.success("Material completed successfully!"),e({isSubmitting:!1})}catch(i){console.error("Error marking material complete:",i.message),e({error:i.message,isSubmitting:!1}),x.error(`Failed to mark material as complete: ${i.message}`)}},generateCertificate:async s=>{e({isSubmitting:!0,error:null});try{const{data:{session:r}}=await w.auth.getSession(),i=r==null?void 0:r.user;if(!i)throw new Error("You must be logged in to generate certificates");if(t().getModuleStatus(s)!=="completed")throw new Error("You must complete all materials in this module first");const{data:c}=await w.from("training_certificates").select("*").eq("user_id",i.id).eq("module_id",s).single();if(c)return e({isSubmitting:!1}),c.certificate_path;const l=t().modules.find(P=>P.id===s);if(!l)throw new Error("Module not found");let u=null;l.expiry_days&&(u=new Date,u.setDate(u.getDate()+l.expiry_days));const p=`certificates/${i.id}/${s}_${Date.now()}.pdf`,{data:f,error:g}=await w.from("training_certificates").insert({user_id:i.id,module_id:s,expires_at:(u==null?void 0:u.toISOString())||null,certificate_path:p}).select().single();if(g)throw g;return await t().fetchCertificates(),x.success("Certificate generated successfully!"),e({isSubmitting:!1}),p}catch(r){return console.error("Error generating certificate:",r.message),e({error:r.message,isSubmitting:!1}),x.error(`Failed to generate certificate: ${r.message}`),null}},getCompletionPercentage:s=>{var u,p;const{completions:r,materials:i}=t();let o="guest";try{const f=JSON.parse(localStorage.getItem("supabase.auth.token")||"{}");o=((p=(u=f==null?void 0:f.currentSession)==null?void 0:u.user)==null?void 0:p.id)||"guest"}catch(f){console.error("Error parsing auth session:",f)}if(o==="guest")return 0;const c=i.filter(f=>f.module_id===s);return c.length===0?0:r.filter(f=>f.module_id===s&&f.user_id===o).length/c.length*100},getModuleStatus:s=>{const r=t().getCompletionPercentage(s);return r===0?"not-started":r===100?"completed":"in-progress"},resetCurrentModule:()=>{e({currentModule:null})},resetCurrentMaterial:()=>{e({currentMaterial:null})}})),yt={user:{id:"123",email:"agent@example.com",fullName:"Agent User",roles:["agent"]},isAuthenticated:!0,isLoading:!1},xt={trainingModules:[{id:"1",title:"Getting Started",description:"Introduction to the platform",status:"active",materials:[{id:"101",title:"Welcome",isCompleted:!0},{id:"102",title:"Basic Navigation",isCompleted:!1}]}],getCompletionPercentage:()=>50,isCertified:()=>!1,fetchTrainingModules:()=>Promise.resolve(),fetchTrainingCompletions:()=>Promise.resolve()};J.mock("../../state/store",async()=>({...await J.importActual("../../state/store"),useStore:()=>yt}));J.mock("../../state/trainingStore",async()=>({...await J.importActual("../../state/trainingStore"),useTrainingStore:()=>xt}));const fs={title:"Pages/Agent/Dashboard",component:de,parameters:{layout:"fullscreen"},decorators:[e=>n.jsx(Nt,{children:n.jsx(e,{})})]},oe={args:{}},ce={parameters:{mockData:{isLoading:!0}},render:()=>(J.mocked(is).mockReturnValue({...yt,isLoading:!0}),n.jsx(de,{}))},le={parameters:{mockData:{isCertified:!0,completionPercentage:100}},render:()=>(J.mocked(ns).mockReturnValue({...xt,getCompletionPercentage:()=>100,isCertified:()=>!0}),n.jsx(de,{}))};var Ye,Ke,Ge;oe.parameters={...oe.parameters,docs:{...(Ye=oe.parameters)==null?void 0:Ye.docs,source:{originalSource:`{
  args: {}
}`,...(Ge=(Ke=oe.parameters)==null?void 0:Ke.docs)==null?void 0:Ge.source}}};var Je,Xe,Ze;ce.parameters={...ce.parameters,docs:{...(Je=ce.parameters)==null?void 0:Je.docs,source:{originalSource:`{
  parameters: {
    mockData: {
      isLoading: true
    }
  },
  render: () => {
    // Override the mock for this specific story
    vi.mocked(storeModule.useStore).mockReturnValue({
      ...mockStore,
      isLoading: true
    });
    return <Dashboard />;
  }
}`,...(Ze=(Xe=ce.parameters)==null?void 0:Xe.docs)==null?void 0:Ze.source}}};var et,tt,st;le.parameters={...le.parameters,docs:{...(et=le.parameters)==null?void 0:et.docs,source:{originalSource:`{
  parameters: {
    mockData: {
      isCertified: true,
      completionPercentage: 100
    }
  },
  render: () => {
    // Override the mock for this specific story
    vi.mocked(trainingStoreModule.useTrainingStore).mockReturnValue({
      ...mockTrainingStore,
      getCompletionPercentage: () => 100,
      isCertified: () => true
    });
    return <Dashboard />;
  }
}`,...(st=(tt=le.parameters)==null?void 0:tt.docs)==null?void 0:st.source}}};const ms=["Default","Loading","Certified"];export{le as Certified,oe as Default,ce as Loading,ms as __namedExportsOrder,fs as default};
